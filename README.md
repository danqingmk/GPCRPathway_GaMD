Su-GaMD User Guide
This guide provides instructions for using the Su-GaMD method to capture key conformations in molecular dynamics simulations and to aid in virtual screening for new drug development. The following steps should be executed on a Linux system, ensuring that PyMOL and Amber are installed.
System Setup
1.	Download PDB File from PDB Bank
o	Download the protein PDB file from the PDB Bank.
2.	Open and Clean Structure in PyMOL
o	Open the file in PyMOL, and remove water, ions, and other unnecessary parts.
o	Save the required structure in PDB format.
3.	Use CHARMM-GUI to Build a Phospholipid Bilayer System
o	Go to CHARMM-GUI.
o	Under the “Input Generator” tab, locate the “Membrane Builder” and click “Bilayer Builder.”
o	Upload the unprocessed PDB file (without H++ treatment) and click “Next Step.”
o	Choose the protein chain(s) to retain and click “Next Step.”
o	Accept the default options and click “Next Step.”
o	In the "Orientation Options" section, select "Run PPM 2.0" and click “Next Step.”
o	Adjust the parameters to set the type and size of the membrane, then click “Next Step.”
o	Select the ion types and concentrations, then click “Next Step.”
o	Click “Next Step” until you reach the download link for step5_assembly.pdb.
4.	Hydrogenation Using H++
o	Go to H++.
o	Click "PROCESS A STRUCTURE."
o	Upload your structure and click “Process File.”
o	Modify the parameters and click "PROCESS…", then wait for processing.
o	Once complete, click "VIEW RESULTS."
o	Under "Other Useful Files," download the PDB file containing the processed structure.
5.	Replace Protein in Bilayer
o	Open the processed PDB file and the membrane assembly PDB file in PyMOL.
o	Replace the protein in the bilayer with the hydrogenated protein and save it as a new PDB file.
6.	Modify Lipid Format
o	Run the following command to convert the lipid format:
o	charmmlipid2amber.py -i *.pdb -o *_out.pdb
7.	Calculate System’s Periodic Boundary Box Size
o	Execute the following to calculate the box size:
o	sh box.sh -i *_out.pdb -s water
o	Example output:
81.35599899291992 80.00199890136719 70.54999923706055
8.	Use Amber's tleap Module
o	Run the following commands:
tleap -s -f leap.in
> complex = loadpdb *_out.pdb
> set complex box {81.35599899291992 80.00199890136719 70.54999923706055}
> bond complex.xx.SG complex.xx.SG  # Connect disulfide bonds (xx is residue number)
> charge complex  # Check charge
> addions complex Na+(Cl-) 0  # Add counterions to neutralize charge
> check complex
> saveamberparm complex com.prmtop com.inpcrd
> quit
9.	Generate com.inpcrd and com.prmtop
o	These files will be used in the next steps.
System Equilibration
1.	Equilibrate the System with cMD
o	Place com.inpcrd and com.prmtop into the “3.cMD-equilibrium” folder.
o	Modify heat.in and equil1.in files by adjusting restraintmask=':1-x', where x is the last residue number of the protein.
o	Run the following command in the background:
nohup sh mdrun.sh &
2.	Generate equil2.rst for the Next Step
Gaussian Accelerated Molecular Dynamics (GaMD)
1.	Run GaMD
o	Place com.prmtop and equil2.rst into the “4.GaMD” folder.
o	Run the following command in the background:
nohup sh gamd.sh &
2.	Generate gamd-restart.dat for the Next Step
Supervised Gaussian Accelerated Molecular Dynamics (Su-GaMD)
1.	Run Su-GaMD
o	Place com.prmtop, com.inpcrd, equil2.rst, gamd-restart.dat, and ref.inpcrd into the “5.Su-GaMD” folder.
o	ref.inpcrd should be the reference structure (the final conformation of the simulation, generated by tleap).
o	Modify the SuMD.py script (line 16) to adjust the variable to either RMSD or Distance for supervision.
o	Run the following command in the background:
nohup python SuMD.py &
